# ğŸ¥ Health Prediction ML Model

MÃ´ hÃ¬nh Machine Learning dá»± bÃ¡o tÃ¬nh tráº¡ng sá»©c khá»e theo mÃ¹a dá»±a trÃªn triá»‡u chá»©ng vÃ  Ä‘iá»u kiá»‡n mÃ´i trÆ°á»ng.

## ğŸ“‹ Tá»•ng quan

Há»‡ thá»‘ng bao gá»“m:

- **train_model.py**: Train mÃ´ hÃ¬nh ML tá»« dá»¯ liá»‡u
- **predict.py**: Sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘á»ƒ dá»± Ä‘oÃ¡n bá»‡nh
- **sample_patient.json**: Dá»¯ liá»‡u bá»‡nh nhÃ¢n máº«u

## ğŸš€ CÃ i Ä‘áº·t

### 1. Táº¡o mÃ´i trÆ°á»ng áº£o

```bash
python -m venv venv
source venv/bin/activate
```

### 2. CÃ i Ä‘áº·t dependencies

#### Sá»­ dá»¥ng pip

```bash
pip install -r requirements.txt
```

## ğŸ¤– Train MÃ´ hÃ¬nh

### Train vá»›i dá»¯ liá»‡u máº«u (tá»± Ä‘á»™ng táº¡o)

```bash
python train_model.py
```

Káº¿t quáº£ train sáº½ hiá»ƒn thá»‹:

- Accuracy score
- Cross-validation score
- Feature importance
- Classification report
- Model Ä‘Æ°á»£c lÆ°u vÃ o `health_prediction_model.pkl`

### Train vá»›i dá»¯ liá»‡u custom

```bash
# Táº¡o file CSV vá»›i format nhÆ° health_data_sample.csv
python train_model.py --data your_data.csv
```

### Káº¿t quáº£ mong Ä‘á»£i

```
ğŸ¥ Health Prediction Model Training
==================================================
ğŸ“Š Creating sample data...
âœ… Created 1000 training samples
Disease distribution:
Healthy              400
Seasonal Flu         250
Common Cold          150
Allergic Rhinitis    100
Heat Exhaustion       50
Gastroenteritis       50

ğŸ¤– Starting model training...
ğŸ¯ Training Random Forest model...

ğŸ“ˆ Training Results:
Accuracy: 0.8950
CV Score: 0.8875 (+/- 0.0234)

ğŸ” Top 5 Important Features:
  fever: 0.1834
  fatigue: 0.1623
  body_aches: 0.1456
  temperature: 0.1234
  weather_temp: 0.0987

âœ… Training completed successfully!
ğŸ’¾ Model saved to health_prediction_model.pkl
```

## ğŸ”® Dá»± Ä‘oÃ¡n

### 1. Dá»± Ä‘oÃ¡n vá»›i dá»¯ liá»‡u máº«u

```bash
python predict.py --sample
```

### 2. Dá»± Ä‘oÃ¡n tÆ°Æ¡ng tÃ¡c (nháº­p liá»‡u tá»« bÃ n phÃ­m)

```bash
python predict.py --interactive
```

VÃ­ dá»¥ nháº­p liá»‡u:

```
ğŸ©º Nháº­p thÃ´ng tin bá»‡nh nhÃ¢n:
------------------------------
Tuá»•i: 30
Giá»›i tÃ­nh (nam/ná»¯): ná»¯

Triá»‡u chá»©ng (y/n):
Sá»‘t: y
Ho: y
Äau Ä‘áº§u: n
Äau há»ng: y
Sá»• mÅ©i: n
Má»‡t má»i: y
Äau nhá»©c cÆ¡ thá»ƒ: y

Nhiá»‡t Ä‘á»™ cÆ¡ thá»ƒ (Â°C, enter Ä‘á»ƒ bá» qua): 38.5

ThÃ´ng tin thá»i tiáº¿t:
Nhiá»‡t Ä‘á»™ thá»i tiáº¿t (Â°C): 20
Äá»™ áº©m (%): 70
Cháº¥t lÆ°á»£ng khÃ´ng khÃ­ (1-5): 3

Äi du lá»‹ch gáº§n Ä‘Ã¢y (y/n): n
Tiáº¿p xÃºc vá»›i ngÆ°á»i bá»‡nh (y/n): y
ThÃ¡ng hiá»‡n táº¡i (1-12): 4
```

### 3. Dá»± Ä‘oÃ¡n tá»« file JSON

```bash
python predict.py --json sample_patient.json
```

### 4. Dá»± Ä‘oÃ¡n vá»›i model custom

```bash
python predict.py --model your_model.pkl --sample
```

## ğŸ“Š Káº¿t quáº£ Dá»± Ä‘oÃ¡n

```
ğŸ¥ Health Prediction Service
========================================
âœ… Model loaded successfully!
ğŸ“‚ Model loaded from health_prediction_model.pkl
Trained at: 2024-01-15T10:30:45.123456

ğŸ”® Making prediction...

ğŸ“Š Prediction Results:
Predicted Disease: Seasonal Flu
Confidence: 0.8750 (87.5%)

ğŸ† Top 3 Predictions:
  1. Seasonal Flu: 0.8750 (87.5%)
  2. Common Cold: 0.1050 (10.5%)
  3. Healthy: 0.0200 (2.0%)

â° Prediction Time: 2024-01-15T14:22:33.456789
ğŸ’¾ Result saved to prediction_result_20240115_142233.json
```

## ğŸ“ Äá»‹nh dáº¡ng dá»¯ liá»‡u

### Input Features (17 features)

```json
{
  "age": 30, // Tuá»•i (5-80)
  "gender": 1, // Giá»›i tÃ­nh (0=ná»¯, 1=nam)
  "temperature": 38.2, // Nhiá»‡t Ä‘á»™ cÆ¡ thá»ƒ (Â°C)
  "fever": 1, // Sá»‘t (0=khÃ´ng, 1=cÃ³)
  "cough": 1, // Ho
  "headache": 0, // Äau Ä‘áº§u
  "sore_throat": 1, // Äau há»ng
  "runny_nose": 0, // Sá»• mÅ©i
  "fatigue": 1, // Má»‡t má»i
  "body_aches": 1, // Äau nhá»©c cÆ¡ thá»ƒ
  "weather_temp": 22, // Nhiá»‡t Ä‘á»™ thá»i tiáº¿t (Â°C)
  "humidity": 70, // Äá»™ áº©m (%)
  "air_quality": 3, // Cháº¥t lÆ°á»£ng khÃ´ng khÃ­ (1-5)
  "season": 1, // MÃ¹a (0=Ä‘Ã´ng, 1=xuÃ¢n, 2=hÃ¨, 3=thu)
  "month": 4, // ThÃ¡ng (1-12)
  "recent_travel": 0, // Du lá»‹ch gáº§n Ä‘Ã¢y (0=khÃ´ng, 1=cÃ³)
  "contact_sick": 1 // Tiáº¿p xÃºc ngÆ°á»i bá»‡nh (0=khÃ´ng, 1=cÃ³)
}
```

### Output Diseases (6 loáº¡i bá»‡nh)

- **Healthy**: Khá»e máº¡nh
- **Common Cold**: Cáº£m láº¡nh thÃ´ng thÆ°á»ng
- **Seasonal Flu**: CÃºm mÃ¹a
- **Allergic Rhinitis**: ViÃªm mÅ©i dá»‹ á»©ng
- **Heat Exhaustion**: Kiá»‡t sá»©c do náº¯ng nÃ³ng
- **Gastroenteritis**: ViÃªm dáº¡ dÃ y ruá»™t

## ğŸ”§ TÃ¹y chá»‰nh Model

### Thay Ä‘á»•i thuáº­t toÃ¡n

Sá»­a trong `train_model.py`:

```python
# Thay RandomForestClassifier báº±ng thuáº­t toÃ¡n khÃ¡c
from sklearn.svm import SVC
from sklearn.neural_network import MLPClassifier

self.model = SVC(probability=True, random_state=42)
# hoáº·c
self.model = MLPClassifier(hidden_layer_sizes=(100, 50), random_state=42)
```

### ThÃªm features má»›i

ThÃªm vÃ o `create_sample_data()`:

```python
data['new_feature'] = np.random.choice([0, 1], n_samples)
```

### ThÃªm bá»‡nh má»›i

Sá»­a logic trong `create_sample_data()`:

```python
elif (your_conditions):
    diseases.append('New Disease')
```

## ğŸ“ˆ ÄÃ¡nh giÃ¡ Model

### Xem chi tiáº¿t performance

```bash
python -c "
from train_model import HealthPredictionTrainer
trainer = HealthPredictionTrainer()
trainer.load_model()
print('Model info:', trainer.model_data)
"
```

### Batch prediction nhiá»u bá»‡nh nhÃ¢n

```python
from predict import HealthPredictor

predictor = HealthPredictor()
patients = [patient1_data, patient2_data, patient3_data]
results = predictor.predict_batch(patients)
print(results)
```

## âš ï¸ LÆ°u Ã½

1. **Dá»¯ liá»‡u máº«u**: Chá»‰ Ä‘á»ƒ demo, khÃ´ng dÃ¹ng cho cháº©n Ä‘oÃ¡n thá»±c táº¿
2. **Model accuracy**: ~87-90% trÃªn dá»¯ liá»‡u máº«u
3. **Medical disclaimer**: KhÃ´ng thay tháº¿ tÆ° váº¥n y táº¿ chuyÃªn nghiá»‡p
4. **Input validation**: LuÃ´n kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o

## ğŸ› Troubleshooting

### Lá»—i scikit-learn trÃªn macOS

```bash
# CÃ i Ä‘áº·t qua conda thay vÃ¬ pip
conda install scikit-learn

# Hoáº·c fix OpenMP
brew install libomp
export LDFLAGS="-L/opt/homebrew/lib -lomp"
pip install scikit-learn
```

### Lá»—i "Model not found"

```bash
# Train model trÆ°á»›c khi predict
python train_model.py
```

### Lá»—i "Missing features"

Äáº£m báº£o input cÃ³ Ä‘á»§ 17 features theo format sample_patient.json

## ğŸ“ Há»— trá»£

- File issues náº¿u gáº·p lá»—i
- Xem log chi tiáº¿t trong console output
- Check requirements.txt compatibility

---

**âš•ï¸ Disclaimer**: ÄÃ¢y lÃ  mÃ´ hÃ¬nh demo cho má»¥c Ä‘Ã­ch há»c táº­p. KhÃ´ng sá»­ dá»¥ng Ä‘á»ƒ cháº©n Ä‘oÃ¡n y táº¿ thá»±c táº¿.
